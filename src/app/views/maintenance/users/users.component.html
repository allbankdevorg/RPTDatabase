<!-- Main Container -->
<!-- <c-container fluid class="mb-3 p-0">
    <c-row>
      <c-col xs>
        <c-card class="mb-4">
          <c-card-header class="d-flex justify-content-between align-items-center">Users
            <button mat-fab extended color="primary"  (click)="addUsers()">
                <mat-icon>add</mat-icon>
                Add
            </button>
          </c-card-header>
          <c-card-body>
            <table
              [hover]="true"
              [responsive]="true"
              [striped]="true"
              align="middle"
              cTable
              class="mb-0 border"
            >
              <thead cTableColor="light">
                <tr>
                  <th>
                    First Name
                  </th>
                  <th>Middle Name</th>
                  <th>Last Name</th>
                  <th>Username</th>
                  <th>Email</th>
                  <th>Mobile #</th>
                  <th>Permissions</th>
                  <th>Department</th>
                  <th class="text-center">Action</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let user of users; index as i">
                  <td>
                    <div>{{ user.fName }}</div>
                  </td>
                  <td>
                      <div>{{ user.mName }}</div>
                  </td>
                  <td>
                    <div>{{ user.lName }}</div>
                  </td>
                  <td>
                    <div>{{ user.userName }}</div>
                  </td>
                  <td>
                    <div>{{ user.email }}</div>
                  </td>
                  <td>
                      <div>{{ user.mobile }}</div>
                  </td>
                  <td>
                    <div>{{ user.authority }}</div>
                </td>
                <td>
                  <div>{{ user.department}}</div>
                </td>
                  <td class="text-center" fxLayout fxLayoutGap="8px">
                      <i class="material-icons mx-1 align-items-center">visibility</i>
                      <i class="material-icons mx-1 align-items-center">create</i> -->
                      <!-- <div class="d-flex justify-content-center">
                        <button mat-icon-button color="primary"  aria-label="View Users Info">
                          <mat-icon>visibility</mat-icon>
                        </button>
                        <button mat-icon-button color="success" (click)="editUsers(user)" aria-label="Edit Users Info">
                          <mat-icon>create</mat-icon>
                        </button>
                        <button mat-icon-button color="warn" (click)="delRelationship()" aria-label="Delete Users">
                          <mat-icon>delete</mat-icon>
                        </button>
                      </div>
                  
                  </td>
                  
                </tr>
              </tbody>
            </table>

            <mat-paginator [pageSizeOptions]="[5, 10, 20]"
                showFirstLastButtons
                aria-label="Select page of data">
            </mat-paginator>
          </c-card-body>
        </c-card>
      </c-col>
    </c-row>
</c-container> -->


<c-container fluid class="mb-3 p-0 position-relative">
  <!-- Button to open a modal -->
  <c-row>
    <c-col xs>
      <c-card class="mb-4">
        <c-card-header class="d-flex justify-content-between align-items-center"><h2>Users Management</h2>
          
        </c-card-header>
        <c-card-body>

          
            <c-container fluid class="my-1 d-flex justify-content-between align-items-center">
              <!-- <c-row> -->
                  <div></div>
                  <button mat-fab extended color="primary"  (click)="addUsers()">
                    <mat-icon>add</mat-icon>
                    Add
                </button>
              <!-- </c-row> -->
            </c-container>
          <c-container fluid>
              <table
              cTable [responsive]="true" mat-table
              [dataSource]="userDataSource" multiTemplateDataRows
              class="mat-elevation-z8 DRI-table mb-0 border">
              <tbody>
                <!-- Expand Button Column -->
                <ng-container matColumnDef="expand">
                  <th *matHeaderCellDef aria-label="row actions"></th>
                  <td mat-cell *matCellDef="let element">
                    <!-- Button to expand/collapse row -->
                    <button mat-icon-button aria-label="expand row" (click)="(expandedElement = expandedElement === element ? null : element); $event.stopPropagation()">
                      <mat-icon *ngIf="expandedElement !== element">keyboard_arrow_down</mat-icon>
                      <mat-icon *ngIf="expandedElement === element">keyboard_arrow_up</mat-icon>
                    </button>
                  </td>
                </ng-container>    

                <!-- First Name-->
                <ng-container matColumnDef="Fname">
                  <thead>
                    <th mat-header-cell *matHeaderCellDef> First Name </th></thead>
                  <td mat-cell *matCellDef="let element"> {{ element.Fname }} </td>
                </ng-container>

                <!-- Middle Name -->
                <ng-container matColumnDef="Mname">
                  <th mat-header-cell *matHeaderCellDef> Middle Name </th>
                  <td mat-cell *matCellDef="let element"> {{ element.Mname }} </td>
                </ng-container>

                <!-- Last Name -->
                <ng-container matColumnDef="Lname">
                  <th mat-header-cell *matHeaderCellDef> Last Name </th>
                  <td mat-cell *matCellDef="let element">{{ element.Lname }}</td>
                </ng-container>


                <!-- UserName -->
                <ng-container matColumnDef="Uname">
                  <th mat-header-cell *matHeaderCellDef> Username </th>
                  <td mat-cell *matCellDef="let element">{{ element.Uname }}</td>
                </ng-container>


                <!-- Email -->
                <ng-container matColumnDef="Email">
                  <th mat-header-cell *matHeaderCellDef> Email</th>
                  <td mat-cell *matCellDef="let element">{{ element.Email }}</td>
                </ng-container>

                <!-- Mobile -->
                <ng-container matColumnDef="Mobile">
                  <th mat-header-cell *matHeaderCellDef> Mobile #</th>
                  <td mat-cell *matCellDef="let element">{{ element.Mobile }}</td>
                </ng-container>

                 <!-- Department -->
                <ng-container matColumnDef="Dept">
                  <th mat-header-cell *matHeaderCellDef> Department</th>
                  <td mat-cell *matCellDef="let element">{{ element.Dept }}</td>
                </ng-container>


                <!-- View/Action Column -->
                <ng-container matColumnDef="view">
                  <th mat-header-cell *matHeaderCellDef> Action </th>
                  <td mat-cell *matCellDef="let element"> 
                    <!-- Button to view details -->
                    <div class="d-flex justify-content-center">
                      <!-- <button mat-icon-button aria-label="View Users Info">
                        <mat-icon>visibility</mat-icon>
                      </button>
                      <button mat-icon-button (click)="editUsers(row)" aria-label="Edit Users Info">
                        <mat-icon>create</mat-icon>
                      </button>
                      <button mat-icon-button color="warn" (click)="delRelationship()" aria-label="Delete Users">
                        <mat-icon>delete</mat-icon>
                      </button> -->

                      <button *ngFor="let buttonId of initializeButtons(element.id, element.role)" [id]="buttonId">
                        {{ buttonId }}
                      </button>
                    </div>
                        <!-- <button class="mx-1 my-1" ></button> -->
                        <!-- <button class="mx-1 my-1" (click)="onRowClick(row)"></button> -->
                  </td>
                </ng-container>

                <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
                <!-- <ng-container matColumnDef="expandedDetail">
                  <td mat-cell *matCellDef="let element" [attr.colspan]="columnsToDisplayWithExpand.length">
                    <div class="example-element-detail" [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'"> -->
                        <!-- Details of the selected element -->
                        <!-- <table cTable [responsive]="true" class="mat-elevation-z8 DRI-table" mat-table [dataSource]="element.authority" > -->
                            <!-- Permissions -->

                            <!-- <ng-container matColumnDef="permissions">
                              <th mat-header-cell *matHeaderCellDef> Permission </th>
                              <td mat-cell *matCellDef="let element"> {{ element.permissions }} </td>
                            </ng-container>

                            <ng-container matColumnDef="access">
                              <th mat-header-cell *matHeaderCellDef> Access </th>
                              <td mat-cell *matCellDef="let element"> {{ element.access }} </td>
                            </ng-container> -->

                            <!-- Header Row -->
                            <!-- <tr mat-header-row  *matHeaderRowDef="permiColumnsToDisplay" class="cTableCol2"></tr> -->
                            <!-- Data Rows -->
                            <!-- <tr mat-row *matRowDef="let row; columns: permiColumnsToDisplay;" class="cTableRow2"></tr> -->
                        <!-- </table>
                      </div>
                    </td> -->
                <!-- </ng-container> -->
                  
                  <!-- Header Row with Expand Button -->
                  <tr mat-header-row *matHeaderRowDef="displayedColumns" class="cTableCol"></tr>
                  
                  <!-- Data Rows with Expandable Detail -->
                  <!-- <tr mat-row *matRowDef="let element; columns: columnsToDisplayWithExpand;"
                      class="example-element-row cTableRow"
                      [class.example-expanded-row]="expandedElement === element"
                      (click)="(expandedElement = expandedElement === element ? null : element); $event.stopPropagation()">
                  </tr> -->

                  <!-- Detail Row -->
                  <tr mat-row *matRowDef="let row; columns: displayedColumns" class="example-detail-row cTableRow" ></tr>
              
                </tbody>
              </table>
              <mat-paginator [pageSizeOptions]="[5, 10, 20]"
                  showFirstLastButtons
                  aria-label="Select page of data">
              </mat-paginator>
          </c-container>
        </c-card-body>
      </c-card>
    </c-col>
  </c-row>
</c-container>

  <!-- End of Main Container -->



<!-- Modals -->

<!-- Add Modals -->
<c-modal id="addUsers" [visible]="addvisible" backdrop="static" (visibleChange)="addUsersChange($event)" size="lg">
    <c-modal-header>
      <h5 cModalTitle>Add Users</h5>
      <button (click)="addUsers()" cButtonClose></button>
    </c-modal-header>
    <c-modal-body>
        <!-- Modal Form -->
        <form cForm class="mb-2">
            <c-modal-body>
              <c-row class="align-items-center">
                
                <c-col [sm]="4">
                    <label cLabel="col" for="fName">First Name</label>
                    <mat-form-field appearance="fill" [style.width.%]=100>
                      <!-- <mat-label>First Name</mat-label> -->
                      <input matInput #accDinput id="fName" name="fName"
                      type="text" placeholder="First Name" appTitleCase>
                    </mat-form-field>
                </c-col>
        
                <c-col [sm]="4">
                    <label cLabel="col" for="mName">Middle Name</label>
                    <mat-form-field appearance="fill" [style.width.%]=100>
                      <!-- <mat-label>Middle Name</mat-label> -->
                      <input matInput #accDinput id="mName"  name="mName"
                      type="text" placeholder="Middle Name" appTitleCase>
                    </mat-form-field>
                </c-col>

                <c-col [sm]="4">
                    <label cLabel="col" for="lName">Last Name</label>
                    <mat-form-field appearance="fill" [style.width.%]=100>
                      <!-- <mat-label>Last Name</mat-label> -->
                      <input matInput #accDinput id="lName"  name="lName"
                      type="text" placeholder="Last Name" appTitleCase>
                    </mat-form-field>
                </c-col>
      
              </c-row>
      
              <c-row class="align-items-center">
                <c-col [sm]="6">
                  <label cLabel="col" for="uEmail">Email</label>
                  <mat-form-field appearance="fill" [style.width.%]=100>
                    <!-- <mat-label>Company Name</mat-label> -->
                    <input matInput #accDinput id="uEmail" name="uEmail"
                    type="text" placeholder="Email Address" appTitleCase>
                  </mat-form-field>
                </c-col>

                <c-col [sm]="6">
                    <label cLabel="col" for="uMobile">Mobile Number</label>
                    <mat-form-field appearance="fill" [style.width.%]=100>
                      <!-- <mat-label>Company Name</mat-label> -->
                      <input matInput #accDinput id="uMobile" name="uMobile"
                      type="text" placeholder="Mobile Number" appNum>
                    </mat-form-field>
                </c-col>
              </c-row>

              <c-row class="align-items-center">
                <c-col [sm]="12">
                  <label cLabel="col" for="uDept">Department</label>
                  <mat-form-field appearance="fill" [style.width.%]="100">
                    <mat-select formControlName="commandControl" placeholder="Department">
                      <mat-option id="uDept">-- None --</mat-option>
                      <mat-option *ngFor="let group of commandGroups" [value]="group.value">
                        {{ group.viewValue }}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </c-col>
              </c-row>

              
              <c-row class="align-items-center">
                <c-col [sm]="6">
                  <label cLabel="col" for="userName">User Name</label>
                  <mat-form-field appearance="fill" [style.width.%]=100>
                    <!-- <mat-label>Company Name</mat-label> -->
                    <input matInput #accDinput id="userName" name="userName"
                    type="text" placeholder="User Name">
                  </mat-form-field>
                </c-col>

                <c-col [sm]="6">
                    <label cLabel="col" for="uPass">Password</label>
                    <mat-form-field appearance="fill" [style.width.%]=100>
                        <!-- <mat-label>Company Name</mat-label> -->
                        <input matInput [type]="hide ? 'password' : 'text'" placeholder="Password" id="uPass">
                        <button mat-icon-button matSuffix (click)="hide = !hide" [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hide">
                          <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
                        </button>
                      </mat-form-field>
                  </c-col>
              </c-row>

            </c-modal-body>
            <c-modal-footer>
              <button type="submit" cButton color="success">Proceed</button>
            </c-modal-footer>
        </form>
    </c-modal-body>
</c-modal>


<!-- Edit Users -->
<c-modal id="editUsers" [visible]="editvisible" backdrop="static" (visibleChange)="editUsersChange($event)" size="lg">
    <c-modal-header>
      <h5 cModalTitle>Edit Users</h5>
      <button (click)="closeUsersModal()" cButtonClose></button>
    </c-modal-header>
    <c-modal-body>
        <!-- Modal Form -->
        <form cForm class="mb-2">
            <c-modal-body>
              <c-row class="align-items-center">
                
                <c-col [sm]="4">
                    <label cLabel="col" for="efName">First Name</label>
                    <mat-form-field appearance="fill" [style.width.%]=100>
                      <!-- <mat-label>First Name</mat-label> -->
                      <input matInput #accDinput id="efName" name="efName"
                      type="text" placeholder="First Name" [value]="editData.fname">
                    </mat-form-field>
                </c-col>
        
                <c-col [sm]="4">
                    <label cLabel="col" for="emName">Middle Name</label>
                    <mat-form-field appearance="fill" [style.width.%]=100>
                      <!-- <mat-label>Middle Name</mat-label> -->
                      <input matInput #accDinput id="emName"  name="emName"
                      type="text" placeholder="Middle Name" [value]="editData.mname">
                    </mat-form-field>
                </c-col>

                <c-col [sm]="4">
                    <label cLabel="col" for="elName">Last Name</label>
                    <mat-form-field appearance="fill" [style.width.%]=100>
                      <!-- <mat-label>Last Name</mat-label> -->
                      <input matInput #accDinput id="elName"  name="elName"
                      type="text" placeholder="Last Name" [value]="editData.lname">
                    </mat-form-field>
                </c-col>
      
              </c-row>
      
              <c-row class="align-items-center">
                <c-col [sm]="6">
                  <label cLabel="col" for="euEmail">Email</label>
                  <mat-form-field appearance="fill" [style.width.%]=100>
                    <!-- <mat-label>Company Name</mat-label> -->
                    <input matInput #accDinput id="euEmail" name="euEmail"
                    type="text" placeholder="Email Address" [value]="editData.email">
                  </mat-form-field>
                </c-col>

                <c-col [sm]="6">
                  <label cLabel="col" for="uDept">Department</label>
                  <mat-form-field appearance="fill" [style.width.%]="100">
                    <mat-select formControlName="commandControl" placeholder="Department">
                      <mat-option id="uDept">-- None --</mat-option>
                      <mat-option *ngFor="let group of commandGroups" [value]="group.value">
                        {{ group.viewValue }}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </c-col>
              </c-row>

              
              <c-row class="align-items-center">
                <c-col [sm]="6">
                    <label cLabel="col" for="euMobile">Mobile Number</label>
                    <mat-form-field appearance="fill" [style.width.%]=100>
                      <!-- <mat-label>Company Name</mat-label> -->
                      <input matInput #accDinput id="euMobile" name="euMobile"
                      type="text" placeholder="Mobile Number" [value]="editData.mobile">
                    </mat-form-field>
                </c-col>

                <c-col [sm]="6">
                  <label cLabel="col" for="euserName">User Name</label>
                  <mat-form-field appearance="fill" [style.width.%]=100>
                    <!-- <mat-label>Company Name</mat-label> -->
                    <input matInput #accDinput id="euserName" name="euserName"
                    type="text" placeholder="User Name" [value]="editData.username">
                  </mat-form-field>
                </c-col>
              </c-row>

              <c-row class="text-center">
                <c-col [sm]="12">
                    <button mat-fab extended color="primary">
                        <mat-icon>refresh</mat-icon>
                        Reset Password
                      </button>
                </c-col>
              </c-row>

            </c-modal-body>
            <c-modal-footer>
              <button type="submit" cButton color="success">Proceed</button>
            </c-modal-footer>
        </form>
    </c-modal-body>
</c-modal>
